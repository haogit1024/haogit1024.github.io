<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 事务 · Hexo</title><meta name="description" content="事务 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://zhihu.com" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/haogit1024" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">事务</h1><div class="post-info">May 22, 2018</div><div class="post-content"><h4 id="首先先复习一下事务的基本知识"><a href="#首先先复习一下事务的基本知识" class="headerlink" title="首先先复习一下事务的基本知识"></a>首先先复习一下事务的基本知识</h4><h5 id="事务介绍"><a href="#事务介绍" class="headerlink" title="事务介绍"></a>事务介绍</h5><p>事务（Transaction），在计算机中一般指对数据库众各种数据项的一个程序执行单元（对数据库的一组操作）。通过事务可以保证一个执行单元内的操作都成功时才更新数据的数据项，否则不会更新数据库。即我们常说的要么全部成功，要么全部失败。  </p>
<h5 id="事务的四个特性"><a href="#事务的四个特性" class="headerlink" title="事务的四个特性"></a>事务的四个特性</h5><ul>
<li>原子性（Atomic）<blockquote>
<p>原子在物理上是不可分割的，表示事务内的操作也是不可分割的，是一体的，所以原子性是指事务要么全部成功，要么全部失败。</p>
</blockquote>
</li>
<li>一致性<blockquote>
<p>忘了，回去翻书。大致上是指事务执行是从一个一致性状态转为另一个一致性状态</p>
</blockquote>
</li>
<li>隔离性<blockquote>
<p>在并发过程中，可能会有多个事务在处理形同的数据。事务之间不能互相干扰，多个事务之间要互相隔离</p>
</blockquote>
</li>
<li>持久性<blockquote>
<p>持久性是指事务提交后，对数据库的修改是永久性的  </p>
</blockquote>
</li>
</ul>
<h5 id="多个事务并发带来的问题"><a href="#多个事务并发带来的问题" class="headerlink" title="多个事务并发带来的问题"></a>多个事务并发带来的问题</h5><ul>
<li>脏读（Dirty reads）<blockquote>
<p>指一个事务读取到另一个事务修改但未提交的数据。如果修改数据事务回滚会导致读取数据事务获取到错误数据</p>
</blockquote>
</li>
<li>不可重复读（Nonrepeatable read）<blockquote>
<p>指一个事务内对同一个数据进行多次查询的到不同的结果。通常是查询间隔期间其他事务修改导致</p>
</blockquote>
</li>
<li>幻读（Phantom read）<blockquote>
<p>与不可重复读类似。指一个事务对一些数据的多次查询得到的数量不一致。通常是查询间隔期间其他事务插入或删除数据导致   </p>
</blockquote>
</li>
</ul>
<p><strong>PS：不可重复读重点是修改，幻读重点是插入和删除</strong></p>
<h5 id="事务隔离"><a href="#事务隔离" class="headerlink" title="事务隔离"></a>事务隔离</h5><p>事务隔离和并发控制类似，都是通过锁来实现的<br><strong>数据库中的各种锁我就不介绍了，用兴趣的同学可以自己找一下资料，这里只介绍数据库中常见的事务隔离级别</strong><br>|事务级别|脏读|不可重复读|幻读|<br>|—|:—:|—:|—:|<br>|READ_UNCOMMITTED|允许|允许|允许|<br>|READ_COMMITTED|禁止|允许|允许|<br>|REPEATABLE_READ|禁止|禁止|允许|<br>|SERIALIZABLE|禁止|禁止|禁止|<br>MySQL默认的事务级别是READ_COMMITTED  </p>
<p>ps：除了数据库的事务级别外，各种库和框架还实现了一些关于事务的其他功能。例如JDBC的数据隔离级别，spirng的事务传播和spirng自己的事务隔离级别。无论是数据库实现还是库、框架实现的功能都是程序员平时需要用到的  </p>
<p><strong>上面这些都是数据库实现的，下面是实践和代码层面的知识</strong></p>
<h4 id="spring中的事务（未完待续）"><a href="#spring中的事务（未完待续）" class="headerlink" title="spring中的事务（未完待续）"></a>spring中的事务（未完待续）</h4><h5 id="spring事务传播"><a href="#spring事务传播" class="headerlink" title="spring事务传播"></a>spring事务传播</h5><h5 id="spring事务隔离级别"><a href="#spring事务隔离级别" class="headerlink" title="spring事务隔离级别"></a>spring事务隔离级别</h5><h5 id="spring编程式事务和生明式事务"><a href="#spring编程式事务和生明式事务" class="headerlink" title="spring编程式事务和生明式事务"></a>spring编程式事务和生明式事务</h5><p>##### </p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/05/09/字符和字符编码/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>