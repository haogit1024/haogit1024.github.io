---
title: IOC和DI
date: 2018-05-07 11:49:31
tags:
---
spring IoC是spring的核心模块之一，几乎所有的spring学习教程或资料都提倡先了解spring IoC。spring IoC贯穿整个spring框架，所有的模块都是用spring IoC container管理bean。  
首先我们先来了解几个概念
* 耦合度
> 耦合度有高低之分
* IoC https://www.zhihu.com/question/21386172?sort=created, https://my.oschina.net/zjzhai/blog/496006 , https://blog.csdn.net/qq_22654611/article/details/52606960
IoC即Inversion of Control是控制反转的意思，这是一种设计思想（模式）。用于解耦。传统的设计：当对象A需要对象B完成某项功能，对象A会创建对象B，此时A和B耦合（A依赖B）且耦合度比较高，A还要负责控制B的生命周期。
* DI
DI即Dependency Injection是控制反转的意思。DI要表达的是一个过程。对象通过构造函数参数、工厂方法参数或其他初始方法"注入"对象，这时候注入的对象和被被注入的对象的依赖关系。其实IoC和DI是同一个意思，只是观察的角度不同产生了两种说法或者说依赖注入更加具体。  
>ps：也有人说控制反转（Inversion of Control）括依赖注入（Dependency Injection）和依赖查找（Dependency Lookup）两个部分。依赖注入和依赖查找组成了IoC

#### IoC
我们假设一个场景：对象A需要对象B完成某项功能  
传统的设计下：对象A会创建对象B，此时A和B耦合（A依赖B）且耦合度比较高，A还要负责控制B的生命周期。  
而在控制反转模式下，程序员会把定义好的对象交给IoC容器同一管理，而不是在对象内部创建，此时A和B耦合（A依赖B），但是依赖程度比较低，A不需要控制B的生命周期。对于这种对对象的控制权由需求方向第三方容器的转义称为控制反转。ioc的思想最核心的地方在于，资源不由使用资源的双方管理。  

上述例子我们明白了两个问题  
1. 控制关系和控制内容：传统的程序是主动创建依赖对象，所以A控制B，而IOC模式下有专门的容器创建对象，所以控制关系是**容器控制对象**。控制的内容是**创建、销毁等生命周期**。  
2. 什么是反转和反转内容：有反转就有正转，程序主动创建以来对象称为正转，由第三方容器创建依赖对象及注入依赖对象称为反转。所以**反转是由容器查找并注入依赖对象**，反转的内容是**依赖兑现的获取**。  

IoC的核心思想是资源不由使用资源的双方管理，而由不使用资源的第三方管理。

#### IOC(DI)的好处
第一，资源集中管理，实现资源的可配置和易管理。第二，降低了使用资源双方的依赖程度，也就是我们说的耦合度。  
1. 资源集中管理，实现资源的可配置和易管理
如果每个对象都是主动去创建资源，会导致资源分散难于管理，稍有不慎还会导致重复创建资源和没有正确关闭资源导致内存泄漏。
2. 降低了使用资源双方的依赖程度，也就是我们说的耦合度
低耦合便于书写代码和维护代码
